#Directory to prepare the .gtf file from cufflinks for extracting the transcriptome out of it including new transcripts.
#Files:
#	- Si_gnG.fa.fai : index file for the gnG genome, generated by samtools index
#	  The columns are: # Chr. name
	  	           # Chr. length
                           # Offset of the first base of the chromosome sequence in the file
                           # Length of the fasta lines
                           # Number of bytes in each fasta line

#	- transcripts.gtf : gtf file generated by cufflinks in 02-read_alignment_rabt

#The R script remove_bad_transcripts.R produces the file 'transcripts_clean.gtf', whithout transcripts exceeding the length of
#their scaffold and those features with empty gene_id attribute.
#Generate a gff3 from the gtf generated by cufflinks using gffread:
gffread -E transcripts_clean.gtf -o- > cufflinks_rabt.gff3
##NEEDS MANUAL MODIFICATION!!! REMOVE THE HEADER!!!!!

#The file needs to be sorted before using
module load genometools
gt gff3 -sort -retainids  cufflinks_rabt.gff3 > cufflinks_rabt_s.gff3

#The file cuff_transcripts_and_genes contains the name of the transcripts and the genes to which they are associated according
#the rabt-generated gff file with cufflinks. It was generated using:
awk '$3=="transcript" {print $9}' cufflinks_rabt_s.gff3 | ruby -pe 'gsub(/^ID=/, "")'|ruby -pe 'gsub(/;.*geneID=/," ")' > cuff_transcripts_and_genes.txt
